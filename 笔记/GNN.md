# 应用领域
- 芯片设计
- 场景分析与问题推理
- 推荐系统
- 知识图谱
- 交通流量预测

# GNN的优点
- 输入数据的格式可以不一样
- 半监督任务：不需要所有点都有标签，计算损失时只考虑有标签的点

# 多层GNN
- 多层GNN可以扩大感受野
- GNN不需要很多层，因为图中任意两个点之间的距离不会太远（认识6个人，就能认识全世界）

# 图卷积网络GCN
对于图$G$，它的邻接矩阵是$A$，它的度矩阵是$D$，结点的特征向量为$X$。
![[Pasted image 20230822134609.png]]
为图中的每个结点增加一个自环，得到新的图$\widetilde{G}$，它的邻接矩阵是$\widetilde{A}$，它的度矩阵是$\widetilde{D}$。
![[Pasted image 20230822135450.png]]
$X' = (A + I)X = \widetilde{A}X$就是卷积得到的新的特征向量。但是这种卷积没有将新的特征向量归一化。卷积后，度数大的结点的特征向量会比度数小的结点的特征向量大。
将度矩阵取逆再乘以新的特征向量，即$X' = \widetilde{D}^{-1}\widetilde{A}X$就是归一化后的特征向量。
但是$\widetilde{D}^{-1}\widetilde{A}$不是一个对称矩阵（左乘$\widetilde{D}^{-1}$只对$\widetilde{A}$的行做了归一化，没有对列做归一化）。此时，
$$a'_{ij} = d^{-1}_{ii} a_{ij}$$
$$X'_{i} = \sum_{j} a'_{ij} X_{j} = \frac{1}{d_{ii}} \sum_{j} a_{ij} X_{j}  = \frac{1}{deg(v_{i})} \sum_{j} a_{ij} X_{j}$$这种算法中，$v_{j}$对$v_{i}$的贡献度只与$v_{i}$的度数有关，而与$v_{j}$的度数无关，这是不合理的（如果$deg(v_j)$很大，则$v_{j}$与$v_{i}$的关系可能并不大）。并且由于$\widetilde{D}^{-1}\widetilde{A}$不是一个对称矩阵，卷积时，$v_{i}$对$v_{j}$的贡献与$v_{j}$对$v_{i}$的贡献不一样大。
为了综合考虑$v_i$和$v_j$的度数，并对特征向量做归一化，我们使用$X' = \widetilde{D}^{-1/2} \widetilde{A} \widetilde{D}^{-1/2} X$作为卷积得到的新的特征向量。此时，
$$a'_{ij} = d^{-1/2}_{ii} a_{ij} d^{-1/2}_{jj}$$
$$X'_{i} = \sum_{j} a'_{ij} X_{j} = \sum_j \frac{a_{ij} X_j}{\sqrt{deg(v_i) \sqrt{deg(v_j)}}}$$

# 图注意力网络GAT
图注意力网络通过根据结点的特征向量计算卷积时各条边的权重。计算权重有多种方法：
- 两个顶点的特征向量求内积
- 把两个顶点的特征向量拼接在一起，然后输入到神经网络中计算权重
![[Pasted image 20230822144821.png]]

# 序列图卷积网络TGCN
如果图的结构随时间变化，或者时间序列上的数据之间有关联，可以使用序列图卷积网络。例如：交通流量预测。可以先在空域上做图卷积，然后将结果输入到诸如RNN或LSTM的结构中做时域卷积。
![[Pasted image 20230822145112.png]]